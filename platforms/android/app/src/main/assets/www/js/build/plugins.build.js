"use strict";(self.webpackChunkcom_foxdebug_acode=self.webpackChunkcom_foxdebug_acode||[]).push([[414],{28538:function(n,e,t){t.r(e),t.d(e,{default:function(){return P}});var i=t(64922),r=t(72050),a=t(7449),s=t(76972),o=t.n(s),c=t(30011),l='<div class="main" id="plugin">\n  <div class="header">\n    <div class="info">\n      <span class="logo" style="background-image: url({{icon}})"></span>\n      <div class="desc">\n        <span class="name">{{name}}</span>\n        <span class="version">{{version}} {{#update}}&#8594; v{{update}}{{/update}}</span>\n        <span class="author" action="open">{{author.name}}</span>\n        <div action="github" class="tag">\n          <span>{{#type}}{{type}}{{/type}}{{^type}}free{{/type}}</span>\n        </div>\n      </div>\n    </div>\n    <div class="button-container primary">\n      {{#installed}}<button action="uninstall">{{strings.uninstall}}</button>{{/installed}}\n      {{^installed}}<button action="install">{{strings.install}}</button>{{/installed}}\n      {{#update}}<button action="install">{{strings.update}}</button>{{/update}}\n      {{#isPaid}}<button action="buy">{{#strings}}{{download acode pro}}{{/strings}}</button>{{/isPaid}}\n    </div>\n  </div>\n  <div class="body md">{{{body}}}</div>\n</div>',u=t(71530),p=t(73291),d=t.n(p),f=t(37519),g=t(23188),v=t(84734),h=t(58021),m=t(70559),Z=t(30334);function y(n,e){return b.apply(this,arguments)}function b(){return(b=(0,a.Z)(o().mark((function n(e,t){var i,s,c,l,u,p,g,y,b,w,x,j,k;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return k=function(n,t){var r=Math.round(1e4*t)/100;i.setTitle("".concat(e.name)),i.setMessage("file: ".concat(n,"\n").concat(strings.installing," ").concat(Math.min(r,100),"%"))},i=h.Z.loader.create(e.name,strings.installing),n.prev=2,e.host=t,e.installed=!0,c=v.Z.join(t,e.main),l=v.Z.dirname(c),u=e.files,s=v.Z.join(PLUGIN_DIR,e.id),n.next=11,(0,m.Z)(s).exists();case 11:if(!n.sent){n.next=14;break}return n.next=14,(0,m.Z)(s).delete();case 14:return(p=[]).push(d()({url:c,method:"GET",contentType:"application/x-www-form-urlencoded",responseType:"arraybuffer",onprogress:function(n,t){k(e.name,n/t)}}),d()({url:v.Z.join(t,e.icon),method:"GET",contentType:"application/x-www-form-urlencoded",responseType:"arraybuffer",onprogress:function(n,e){k("icon",n/e)}}),d()({url:v.Z.join(t,e.readme),method:"GET",contentType:"application/x-www-form-urlencoded",responseType:"arraybuffer",onprogress:function(n,e){k("readme",n/e)}})),n.next=18,Promise.all(p);case 18:return g=n.sent,y=(0,r.Z)(g,3),b=y[0],w=y[1],x=y[2],n.next=25,(0,m.Z)(PLUGIN_DIR).createDirectory(e.id);case 25:return(j=[]).push((0,m.Z)(s).createFile("main.js",b),(0,m.Z)(s).createFile("plugin.json",JSON.stringify(e,null,2)),(0,m.Z)(s).createFile("readme.md",x),(0,m.Z)(s).createFile("icon.png",w)),Array.isArray(u)&&u.forEach((function(n){j.push((0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.Z.createFileRecursive(s,n);case 2:return e.t0=(0,m.Z)(v.Z.join(s,n)),e.next=5,d()({url:v.Z.join(l,n),method:"GET",contentType:"application/x-www-form-urlencoded",responseType:"arraybuffer",onprogress:function(e,t){k(n,e/t)}});case 5:return e.t1=e.sent,e.next=8,e.t0.writeFile.call(e.t0,e.t1);case 8:case"end":return e.stop()}}),e)})))())})),n.next=30,Promise.all(j);case 30:toast(strings.success),(0,Z.Z)(e.id),n.next=40;break;case 34:if(n.prev=34,n.t0=n.catch(2),!s){n.next=39;break}return n.next=39,(0,m.Z)(s).delete();case 39:throw new Error("Cannot install plugin");case 40:return n.prev=40,h.Z.loader.destroy(),n.finish(40);case 43:case"end":return n.stop()}}),n,null,[[2,34,40,43]])})))).apply(this,arguments)}var w=t(89184),x=t.n(w),j=t(59661);function k(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,i)}return t}function T(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?k(Object(t),!0).forEach((function(e){(0,i.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):k(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function P(n){return O.apply(this,arguments)}function O(){return O=(0,a.Z)(o().mark((function n(e){var t,i,s,p,h,Z,b,w,k,P,O,I,L,D,E,A,N,S,_,G,F=arguments;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(G=function(){return(G=(0,a.Z)(o().mark((function n(){var e,i;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e=["paid","premium","pro"].includes(k.type)&&IS_FREE_VERSION,"file:"!==v.Z.getProtocol(b)){n.next=5;break}return n.next=4,f.Z.toInternalUri(b);case 4:b=n.sent;case 5:p.body=x().parse(c.Z.render(l,T(T({},k),{},{readme:Z,version:w,icon:b,body:Z?(0,g.TU)(Z):"",installed:t,update:O,strings:strings,isPaid:e}))),e&&(i=p.get('[action="install"]'))&&(i.style.display="none");case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)},_=function(){return G.apply(this,arguments)},S=function(n){var e=n.target.getAttribute("action");if("install"===e){if(!I)return void toast("Cannot install plugin");y(I,L).then((function(){acode.unmountPlugin(k.id),i(k.id),t=!0,O=!1,_()})).catch((function(n){f.Z.error(n)}))}"uninstall"===e&&(0,m.Z)(v.Z.join(PLUGIN_DIR,k.id)).delete().then((function(){acode.unmountPlugin(k.id),s(k.id),t=!1,O=!1,_()})).catch((function(n){f.Z.error(n)})),"buy"===e&&system.openInBrowser(j.Z.PAID_VERSION)},t=F.length>1&&void 0!==F[1]&&F[1],i=F.length>2?F[2]:void 0,s=F.length>3?F[3]:void 0,p=(0,u.Z)("Plugin"),h=v.Z.dirname(e),Z="",b="",w="",k={},P=!1,O=!1,actionStack.push({id:"plugin",action:p.hide}),p.onhide=function(){f.Z.hideAd(),actionStack.remove("plugin"),f.Z.removeTitleLoader(),P=!0},p.onclick=S,app.append(p),f.Z.showAd(),f.Z.showTitleLoader(),n.prev=20,D=[],E="",t?(D.push((0,m.Z)(e).readFile("utf8"),(0,m.Z)(v.Z.join(h,"readme.md")).readFile("utf8")),b=v.Z.join(h,"icon.png")):D.push(d()({url:e,responseType:"text",contentType:"application/x-www-form-urlencoded"})),!P){n.next=26;break}return n.abrupt("return");case 26:return n.next=28,Promise.all(D);case 28:A=n.sent,N=(0,r.Z)(A,2),E=N[0],Z=N[1],k=f.Z.parseJSON(E),w=k.version,!b&&k.icon&&(b=v.Z.join(h,k.icon)),p.settitle(k.name),_(),!Z&&k.readme&&d()({url:v.Z.join(h,k.readme),responseType:"text",contentType:"application/x-www-form-urlencoded"}).then((function(n){Z=n,_()})),t?d()({url:v.Z.join(k.host,"plugin.json"),responseType:"text",contentType:"application/x-www-form-urlencoded"}).then((function(n){I=f.Z.parseJSON(n),L=k.host,I.version!==w&&(O=I.version,_())})):(I=k,L=h),n.next=44;break;case 41:n.prev=41,n.t0=n.catch(20),f.Z.error(n.t0);case 44:return n.prev=44,f.Z.hideAd(),f.Z.removeTitleLoader(),n.finish(44);case 48:case"end":return n.stop()}}),n,null,[[20,41,44,48]])}))),O.apply(this,arguments)}},83671:function(n,e,t){t.r(e),t.d(e,{default:function(){return m}});var i=t(7449),r=t(76972),a=t.n(r),s=t(73291),o=t.n(s),c=t(30011),l=t(89184),u=t.n(l),p='{{#.}}\n<div class="list-item" action="open" {{#installed}}data-installed="true"{{/installed}} data-plugin="{{plugin}}">\n  <span \n    class="icon" \n    style="background-image: url({{#icon}}{{icon}}{{/icon}}{{^icon}}./res/puzzle.png{{/icon}});"\n  ></span>\n  <div class="container">\n    <div class="text" style="justify-content: space-between;">\n      <a>{{name}}</a>\n    </div>\n    <small class="value">\n      {{#author}}<span action="open" data-href="https://github.com/{{github}}" class="text link">{{name}}</span>{{/author}}\n    </small>\n  </div>\n</div>\n{{/.}}',d=t(71530),f=t(37519),g=t(64413),v=t(70559),h=t(84734);function m(n){var e="https://raw.githubusercontent.com/deadlyjack/acode-plugins/main/list.json",r=(0,d.Z)(strings.plugins),s=u()("span",{className:"icon search",attr:{action:"search"}}),l={all:[],installed:[]},m="installed",Z=0,y=0;if(r.body.innerHTML=c.Z.render("<div class='main' id='plugins'>\n  <div class='options'>\n    <span action='select' tabindex='0' value='all' class='active'>All</span>\n    <span action='select' tabindex='0' value='installed'>Installed</span>\n  </div>\n  <div id='plugin-list' class='list scroll' empty-msg='{{msg}}'></div>\n</div>",{msg:strings["loading..."]}),r.header.append(s),actionStack.push({id:"plugins",action:r.hide}),r.onhide=function(){f.Z.hideAd(),actionStack.remove("plugins"),f.Z.removeTitleLoader()},r.onclick=function(n){var e=n.target,i=e.getAttribute("action");"search"!==i?"open"!==i?"select"===i&&(m=e.getAttribute("value"),b()):function(n,e,i){var r=n.plugin,a=n.installed;t.e(414).then(t.bind(t,28538)).then((function(n){(0,n.default)(r,a,e,i)}))}(e.dataset,k,T):(0,g.Z)(r.get("#plugins"))},app.append(r),f.Z.showAd(),n)return r.get(".options").style.display="none",r.settitle(strings.update),void x(n).then(b);function b(){var n,e,t,i,a=r.get("#plugin-list"),s=strings["no plugins found"];"all"===m&&(0===Z&&(s=strings["loading..."]),null===(n=r.get('[action="select"].active'))||void 0===n||n.classList.remove("active"),null===(e=r.get('[action="select"][value="all"]'))||void 0===e||e.classList.add("active"),r.get("#plugin-list").innerHTML=c.Z.render(p,l.all)),"installed"===m&&(0===y&&(s=strings["loading..."]),null===(t=r.get('[action="select"].active'))||void 0===t||t.classList.remove("active"),null===(i=r.get('[action="select"][value="installed"]'))||void 0===i||i.classList.add("active"),r.get("#plugin-list").innerHTML=c.Z.render(p,l.installed)),a.setAttribute("empty-msg",s)}function w(){return(w=(0,i.Z)(a().mark((function n(){var t,i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,v.Z)(PLUGIN_DIR).lsDir();case 3:return t=n.sent,n.next=6,o()({url:e,method:"GET",responseType:"text",contentType:"application/x-www-form-urlencoded"});case 6:i=n.sent,l.all=f.Z.parseJSON(i)||[],t.forEach((function(n){var e=n.url,t=l.all.find((function(n){return n.id===h.Z.basename(e)}));t&&(t.installed=!0,t.plugin=P(t.id,"plugin.json"))})),Z=1,n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),f.Z.error(n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,12]])})))).apply(this,arguments)}function x(n){return j.apply(this,arguments)}function j(){return j=(0,i.Z)(a().mark((function n(e){var t;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,v.Z)(PLUGIN_DIR).lsDir();case 2:return t=n.sent,n.next=5,Promise.all(t.map(function(){var n=(0,i.Z)(a().mark((function n(t){var i,r,s,o,c;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=h.Z.basename(t.url),!(e&&e.includes(i)||!e)){n.next=13;break}return r=h.Z.join(t.url,"plugin.json"),n.next=5,(0,v.Z)(r).readFile("json");case 5:return s=n.sent,o=s.id,c=P(o,"icon.png"),n.next=10,f.Z.toInternalUri(c);case 10:s.icon=n.sent,s.plugin=P(o,"plugin.json"),l.installed.push(s);case 13:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()));case 5:y=1;case 6:case"end":return n.stop()}}),n)}))),j.apply(this,arguments)}function k(n){var e=l.all.find((function(e){return e.id===n}));e&&(e.installed=!0,l.installed.push(e)),b()}function T(n){var e=l.installed.find((function(e){return e.id===n}));e&&(e.installed=!1,l.installed=l.installed.filter((function(e){return e.id!==n}))),b()}function P(n,e){return h.Z.join(PLUGIN_DIR,n,e)}!function(){w.apply(this,arguments)}(),x().then((function(){b()}))}}}]);