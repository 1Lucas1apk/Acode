"use strict";(self.webpackChunkcom_foxdebug_acode=self.webpackChunkcom_foxdebug_acode||[]).push([[150],{41097:function(e,t,r){r.r(t),r.d(t,{default:function(){return g}});var n=r(7449),a=r(76972),s=r.n(a),i=r(89184),c=r.n(i),o=r(30011),l=r(87771),u=r(71530),p=r(37519),d=r(58021),h=r(6700),f=r(64413),m=r(55221);function g(e,t){var r,a,i=c().parse("<div class='main' id='repo-tree'>\r\n  <div class='navigation'></div>\r\n</div>"),g=i.querySelector(".navigation"),v=h.Z.GitHub().getRepo(e,t),b=c()("span",{className:"icon search",attr:{action:"search"}}),k={"/":{name:"/",sha:"/",list:[]}},Z={list:[],name:"",sha:"",scroll:0},x=[],y={id:"from",placeholder:strings["use branch"],hints:function(e){e(x.slice(0,-1))},type:"text"},w={id:"branch",placeholder:strings["new branch"],type:"text",match:/^[a-z\-_0-9]+$/i},S=[],F=!1;function L(){d.Z.loader.create(t,strings.loading+"..."),v.getSha(a,"").then((function(e){var n=N(e.data);r=(0,u.Z)(t+" (".concat(a,")"),{lead:c()("span",{className:"icon clearclose",attr:{action:"close"}})}),k["/"].list=n,D("/","/"),r.addEventListener("click",A),r.body=i,r.header.append(b),app.append(r),p.Z.showAd(),actionStack.setMark(),actionStack.push({id:"repo",action:r.hide}),r.onhide=function(){p.Z.hideAd(F),actionStack.pop(),r.removeEventListener("click",A),actionStack.clearFromMark(),actionStack.remove("repo")}})).catch((function(e){p.Z.error(e)})).finally((function(){d.Z.loader.destroy()}))}function A(c){var o=c.target,u=o.getAttribute("action");u&&function(c,o){var u=o.getAttribute("sha"),h=o.getAttribute("name");switch(c){case"close":r.hide();break;case"navigate":D(h,u);break;case"file":!function(){g.apply(this,arguments)}();break;case"search":(0,f.Z)(i.get(".list"))}function g(){return(g=(0,n.Z)(s().mark((function n(){var i,c,o,f,g,b;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,p.Z.showTitleLoader(),i=p.Z.extname(h),c=l.lookup(i),o=/image/i.test(c)?"image":null,n.next=7,v.getBlob(u,"blob");case 7:if(f=n.sent,g=f.data,"image"!==o){n.next=12;break}return d.Z.box(h,"<img src='".concat(URL.createObjectURL(g),"'>")),n.abrupt("return");case 12:if(!(g instanceof Blob)){n.next=29;break}if(n.prev=13,!g.text){n.next=20;break}return n.next=17,g.text();case 17:g=n.sent,n.next=23;break;case 20:return n.next=22,p.Z.blob2text(g);case 22:g=n.sent;case 23:n.next=29;break;case 25:n.prev=25,n.t0=n.catch(13),console.error(n.t0),d.Z.alert(strings.error,strings["unable to open file"]);case 29:b=gitRecord.add({sha:u,data:g,name:h,branch:a,repo:t,path:S.slice(1).join("/"),owner:e}),F=!0,new m.Z(h,{type:"git",record:b,text:g,isUnsaved:!1}),r.hide(),n.next=38;break;case 35:n.prev=35,n.t1=n.catch(0),R(n.t1);case 38:return n.prev=38,p.Z.removeTitleLoader(),n.finish(38);case 41:case"end":return n.stop()}}),n,null,[[0,35,38,41],[13,25]])})))).apply(this,arguments)}}(u,o)}function B(e){var t=e.list,r=e.scroll,n=void 0===r?0:r,a=i.get(".list");a&&a.remove();var s=c().parse(o.Z.render('<div class="list" id="repo-list" empty-message="{{msg}}">{{#list}}{{#.}}\r\n  <div class="list-item" sha="{{sha}}" name="{{name}}"\r\n    action="{{#isDirectory}}navigate{{/isDirectory}}{{#isFile}}file{{/isFile}}">\r\n    <span class="icon {{icon}}"></span>\r\n    <span class="container">\r\n      <div class="text">\r\n        <span>{{name}}</span>\r\n      </div>\r\n      {{#isFile}}\r\n      <small class="value">{{size}}</small>\r\n      {{/isFile}}\r\n    </span>\r\n  </div>\r\n  {{/.}}{{/list}}\r\n</div>',{msg:strings["empty folder message"],list:t}));i.append(s),s.scrollTop=n}function D(e,t){return T.apply(this,arguments)}function T(){return(T=(0,n.Z)(s().mark((function e(t,r){var n,a,o,l,u,p,d,h,f,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=g.get('[sha="'.concat(r,'"]')))){e.next=13;break}for(o=null;(a=g.lastChild)!==n;)l=a.getAttribute("sha"),actionStack.remove(l),a.remove(),S.pop(),o&&o in k&&delete k[o],o=l;return e.next=6,_(t,r);case 6:if(!(u=e.sent)){e.next=11;break}return B(u),Z=u,e.abrupt("return");case 11:return B({list:[],scroll:0}),e.abrupt("return");case 13:return e.next=15,_(t,r);case 15:(p=e.sent)&&((d=i.get(".list"))&&(Z.scroll=d.scrollTop),S.push(t),g.append(c()("span",{className:"nav",attr:{sha:r,action:"navigate",text:t,name:t}})),g.scrollLeft=g.scrollWidth,f=(h=Z).sha,m=h.name,f&&m&&actionStack.push({id:r,action:function(){D(m,f)}}),B(p),k[r]=p,Z=p);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return z.apply(this,arguments)}function z(){return(z=(0,n.Z)(s().mark((function e(r,n){var a,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n in k)){e.next=2;break}return e.abrupt("return",k[n]);case 2:return a=null,d.Z.loader.create(t,strings.loading+"..."),e.prev=4,e.next=7,v.getTree(n);case 7:i=e.sent,c=N(c=i.data.tree),a={list:c,name:r,sha:n,scroll:0},e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),R(e.t0);case 16:return d.Z.loader.destroy(),e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,null,[[4,13]])})))).apply(this,arguments)}function N(e){return e.map((function(e){var t=e.size,r=e.type;e.size=(t/1024).toFixed(2)+"KB",!e.name&&e.path&&(e.name=e.path),e.isDirectory="dir"===r||"tree"===r,e.isFile=!e.isDirectory,e.type=e.isDirectory?"folder":p.Z.getIconForFile(e.name)})),p.Z.sortDir(e,{showHiddenFiles:!0,sortByName:!0})}function R(e){console.error(e),actionStack.pop(),d.Z.alert(strings.error,e.toString())}d.Z.loader.create(t,strings.loading+"..."),v.listBranches().then((function(e){return d.Z.loader.destroy(),e.data.map((function(e){return x.push(e.name)})),x.push(["add",strings["new branch"],"add"]),d.Z.select(strings["select branch"],x)})).then((function(e){"add"===e?d.Z.multiPrompt(strings["create new branch"],[y,w]).then((function(e){var t=e.from;return a=e.branch,d.Z.loader.create("",strings.loading+"..."),v.createBranch(t,a)})).then(L).catch((function(e){p.Z.error(e)})).finally((function(){d.Z.loader.destroy()})):(a=e,L())})).catch((function(e){p.Z.error(e),d.Z.loader.destroy()}))}}}]);