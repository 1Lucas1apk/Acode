"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkcom_foxdebug_acode"] = self["webpackChunkcom_foxdebug_acode"] || []).push([["repo"],{

/***/ "./src/pages/repo/repo.include.js":
/*!****************************************!*\
  !*** ./src/pages/repo/repo.include.js ***!
  \****************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ RepoInclude; }\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _repo_hbs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./repo.hbs */ \"./src/pages/repo/repo.hbs\");\n/* harmony import */ var _list_hbs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./list.hbs */ \"./src/pages/repo/list.hbs\");\n/* harmony import */ var _repo_scss__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./repo.scss */ \"./src/pages/repo/repo.scss\");\n/* harmony import */ var html_tag_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! html-tag-js */ \"./node_modules/html-tag-js/dist/tag.js\");\n/* harmony import */ var html_tag_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(html_tag_js__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var mustache__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! mustache */ \"./node_modules/mustache/mustache.mjs\");\n/* harmony import */ var mime_types__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! mime-types */ \"./node_modules/mime-types/index.js\");\n/* harmony import */ var _components_page__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../components/page */ \"./src/components/page.js\");\n/* harmony import */ var _utils_helpers__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../utils/helpers */ \"./src/utils/helpers.js\");\n/* harmony import */ var _components_dialogs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../components/dialogs */ \"./src/components/dialogs.js\");\n/* harmony import */ var _lib_git__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../lib/git */ \"./src/lib/git.js\");\n/* harmony import */ var _components_searchbar__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../components/searchbar */ \"./src/components/searchbar.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction RepoInclude(owner, repoName) {\n  var $page;\n  var $content = html_tag_js__WEBPACK_IMPORTED_MODULE_5___default().parse(_repo_hbs__WEBPACK_IMPORTED_MODULE_2__[\"default\"]);\n  var $navigation = $content.querySelector('.navigation');\n  var repo = _lib_git__WEBPACK_IMPORTED_MODULE_11__[\"default\"].GitHub().getRepo(owner, repoName);\n  var $search = html_tag_js__WEBPACK_IMPORTED_MODULE_5___default()('span', {\n    className: 'icon search',\n    attr: {\n      action: 'search'\n    }\n  });\n  var cachedTree = {\n    '/': {\n      name: '/',\n      sha: '/',\n      list: []\n    }\n  };\n  var currentTree = {\n    list: [],\n    name: '',\n    sha: '',\n    scroll: 0\n  };\n  var branch;\n  var branches = [];\n  var input1 = {\n    id: 'from',\n    placeholder: strings['use branch'],\n    hints: function hints(cb) {\n      cb(branches.slice(0, -1));\n    },\n    type: 'text'\n  };\n  var input2 = {\n    id: 'branch',\n    placeholder: strings['new branch'],\n    type: 'text',\n    match: /^[a-z\\-_0-9]+$/i\n  };\n  var path = [];\n  var hideAd = false; // If user select a file to open, hide the ad\n\n  _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].loader.create(repoName, strings.loading + '...');\n  repo.listBranches().then(function (res) {\n    _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].loader.destroy();\n    var data = res.data;\n    data.map(function (branch) {\n      return branches.push(branch.name);\n    });\n    branches.push(['add', strings['new branch'], 'add']);\n    return _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].select(strings['select branch'], branches);\n  }).then(function (res) {\n    if (res === 'add') {\n      addBranch();\n    } else {\n      branch = res;\n      getRepo();\n    }\n  }).catch(function (err) {\n    _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].error(err);\n    _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].loader.destroy();\n  });\n\n  function addBranch() {\n    _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].multiPrompt(strings['create new branch'], [input1, input2]).then(function (res) {\n      var from = res.from;\n      branch = res.branch;\n      _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].loader.create('', strings.loading + '...');\n      return repo.createBranch(from, branch);\n    }).then(getRepo).catch(function (err) {\n      _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].error(err);\n    }).finally(function () {\n      _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].loader.destroy();\n    });\n  }\n\n  function getRepo() {\n    _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].loader.create(repoName, strings.loading + '...');\n    repo.getSha(branch, '').then(function (res) {\n      var list = transofrmRepoList(res.data);\n      $page = (0,_components_page__WEBPACK_IMPORTED_MODULE_8__[\"default\"])(repoName + \" (\".concat(branch, \")\"), {\n        lead: html_tag_js__WEBPACK_IMPORTED_MODULE_5___default()('span', {\n          className: 'icon clearclose',\n          attr: {\n            action: 'close'\n          }\n        })\n      });\n      cachedTree['/'].list = list;\n      navigate('/', '/');\n      $page.addEventListener('click', handleClick);\n      $page.body = $content;\n      $page.header.append($search);\n      app.append($page);\n      _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].showAd();\n      actionStack.setMark();\n      actionStack.push({\n        id: 'repo',\n        action: $page.hide\n      });\n\n      $page.onhide = function () {\n        _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].hideAd(hideAd);\n        actionStack.pop();\n        $page.removeEventListener('click', handleClick);\n        actionStack.clearFromMark();\n        actionStack.remove('repo');\n      };\n    }).catch(function (err) {\n      _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].error(err);\n    }).finally(function () {\n      _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].loader.destroy();\n    });\n  }\n  /**\r\n   *\r\n   * @param {MouseEvent} e\r\n   */\n\n\n  function handleClick(e) {\n    /**\r\n     * @type {HTMLElement}\r\n     */\n    var $el = e.target;\n    var action = $el.getAttribute('action');\n    if (!action) return;\n    performeAction(action, $el);\n  }\n  /**\r\n   *\r\n   * @param {{list: Array<Object>, scroll: Number}} param0\r\n   */\n\n\n  function render(_ref) {\n    var list = _ref.list,\n        _ref$scroll = _ref.scroll,\n        scroll = _ref$scroll === void 0 ? 0 : _ref$scroll;\n    var $oldList = $content.get('.list');\n    if ($oldList) $oldList.remove();\n    var $list = html_tag_js__WEBPACK_IMPORTED_MODULE_5___default().parse(mustache__WEBPACK_IMPORTED_MODULE_6__[\"default\"].render(_list_hbs__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n      msg: strings['empty folder message'],\n      list: list\n    }));\n    $content.append($list);\n    $list.scrollTop = scroll;\n  }\n  /**\r\n   *\r\n   * @param {String} name\r\n   * @param {String} sha\r\n   */\n\n\n  function navigate(_x, _x2) {\n    return _navigate.apply(this, arguments);\n  }\n\n  function _navigate() {\n    _navigate = (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[\"default\"])( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark(function _callee2(name, sha) {\n      var $nav, $topNav, oldsha, _sha, _tree, tree, $list, _currentTree, csha, cname;\n\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              $nav = $navigation.get(\"[sha=\\\"\".concat(sha, \"\\\"]\"));\n\n              if (!$nav) {\n                _context2.next = 13;\n                break;\n              }\n\n              oldsha = null;\n\n              while (($topNav = $navigation.lastChild) !== $nav) {\n                _sha = $topNav.getAttribute('sha');\n                actionStack.remove(_sha);\n                $topNav.remove();\n                path.pop();\n\n                if (oldsha && oldsha in cachedTree) {\n                  delete cachedTree[oldsha];\n                }\n\n                oldsha = _sha;\n              }\n\n              _context2.next = 6;\n              return getTree(name, sha);\n\n            case 6:\n              _tree = _context2.sent;\n\n              if (!_tree) {\n                _context2.next = 11;\n                break;\n              }\n\n              render(_tree);\n              currentTree = _tree;\n              return _context2.abrupt(\"return\");\n\n            case 11:\n              render({\n                list: [],\n                scroll: 0\n              });\n              return _context2.abrupt(\"return\");\n\n            case 13:\n              _context2.next = 15;\n              return getTree(name, sha);\n\n            case 15:\n              tree = _context2.sent;\n\n              if (tree) {\n                $list = $content.get('.list');\n                if ($list) currentTree.scroll = $list.scrollTop;\n                path.push(name);\n                $navigation.append(html_tag_js__WEBPACK_IMPORTED_MODULE_5___default()('span', {\n                  className: 'nav',\n                  attr: {\n                    sha: sha,\n                    action: 'navigate',\n                    text: name,\n                    name: name\n                  }\n                }));\n                $navigation.scrollLeft = $navigation.scrollWidth;\n                _currentTree = currentTree, csha = _currentTree.sha, cname = _currentTree.name;\n\n                if (csha && cname) {\n                  actionStack.push({\n                    id: sha,\n                    action: function action() {\n                      navigate(cname, csha);\n                    }\n                  });\n                }\n\n                render(tree);\n                cachedTree[sha] = tree;\n                currentTree = tree;\n              }\n\n            case 17:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _navigate.apply(this, arguments);\n  }\n\n  function getTree(_x3, _x4) {\n    return _getTree.apply(this, arguments);\n  }\n\n  function _getTree() {\n    _getTree = (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[\"default\"])( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark(function _callee3(name, sha) {\n      var tree, res, list;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!(sha in cachedTree)) {\n                _context3.next = 2;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", cachedTree[sha]);\n\n            case 2:\n              tree = null;\n              _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].loader.create(repoName, strings.loading + '...');\n              _context3.prev = 4;\n              _context3.next = 7;\n              return repo.getTree(sha);\n\n            case 7:\n              res = _context3.sent;\n              list = res.data.tree;\n              list = transofrmRepoList(list);\n              tree = {\n                list: list,\n                name: name,\n                sha: sha,\n                scroll: 0\n              };\n              _context3.next = 16;\n              break;\n\n            case 13:\n              _context3.prev = 13;\n              _context3.t0 = _context3[\"catch\"](4);\n              error(_context3.t0);\n\n            case 16:\n              _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].loader.destroy();\n              return _context3.abrupt(\"return\", tree);\n\n            case 18:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[4, 13]]);\n    }));\n    return _getTree.apply(this, arguments);\n  }\n\n  function transofrmRepoList(list) {\n    list.map(function (entry) {\n      var size = entry.size,\n          type = entry.type;\n      entry.size = (size / 1024).toFixed(2) + 'KB';\n      if (!entry.name && entry.path) entry.name = entry.path;\n      entry.isDirectory = type === 'dir' || type === 'tree';\n      entry.isFile = !entry.isDirectory;\n      entry.type = entry.isDirectory ? 'folder' : _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].getIconForFile(entry.name);\n    });\n    return _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].sortDir(list, {\n      showHiddenFiles: true,\n      sortByName: true\n    });\n  }\n  /**\r\n   *\r\n   * @param {string} action\r\n   * @param {HTMLElement} $el\r\n   */\n\n\n  function performeAction(action, $el) {\n    var sha = $el.getAttribute('sha');\n    var name = $el.getAttribute('name');\n\n    switch (action) {\n      case 'close':\n        $page.hide();\n        break;\n\n      case 'navigate':\n        navigate(name, sha);\n        break;\n\n      case 'file':\n        file();\n        break;\n\n      case 'search':\n        (0,_components_searchbar__WEBPACK_IMPORTED_MODULE_12__[\"default\"])($content.get('.list'));\n        break;\n    }\n\n    function file() {\n      return _file.apply(this, arguments);\n    }\n\n    function _file() {\n      _file = (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[\"default\"])( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark(function _callee() {\n        var ext, mime, type, blob, data, record;\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].showTitleLoader();\n                ext = _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].extname(name);\n                mime = mime_types__WEBPACK_IMPORTED_MODULE_7__.lookup(ext);\n                type = /image/i.test(mime) ? 'image' : null;\n                _context.next = 7;\n                return repo.getBlob(sha, 'blob');\n\n              case 7:\n                blob = _context.sent;\n                data = blob.data;\n\n                if (!(type === 'image')) {\n                  _context.next = 12;\n                  break;\n                }\n\n                _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].box(name, \"<img src='\".concat(URL.createObjectURL(data), \"'>\"));\n                return _context.abrupt(\"return\");\n\n              case 12:\n                if (!(data instanceof Blob)) {\n                  _context.next = 29;\n                  break;\n                }\n\n                _context.prev = 13;\n\n                if (!data.text) {\n                  _context.next = 20;\n                  break;\n                }\n\n                _context.next = 17;\n                return data.text();\n\n              case 17:\n                data = _context.sent;\n                _context.next = 23;\n                break;\n\n              case 20:\n                _context.next = 22;\n                return _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].blob2text(data);\n\n              case 22:\n                data = _context.sent;\n\n              case 23:\n                _context.next = 29;\n                break;\n\n              case 25:\n                _context.prev = 25;\n                _context.t0 = _context[\"catch\"](13);\n                console.error(_context.t0);\n                _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].alert(strings.error, strings['unable to open file']);\n\n              case 29:\n                record = gitRecord.add({\n                  sha: sha,\n                  data: data,\n                  name: name,\n                  branch: branch,\n                  repo: repoName,\n                  path: path.slice(1).join('/'),\n                  owner: owner\n                });\n                hideAd = true;\n                editorManager.addNewFile(name, {\n                  type: 'git',\n                  record: record,\n                  text: data,\n                  isUnsaved: false\n                });\n                $page.hide();\n                _context.next = 38;\n                break;\n\n              case 35:\n                _context.prev = 35;\n                _context.t1 = _context[\"catch\"](0);\n                error(_context.t1);\n\n              case 38:\n                _context.prev = 38;\n                _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].removeTitleLoader();\n                return _context.finish(38);\n\n              case 41:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 35, 38, 41], [13, 25]]);\n      }));\n      return _file.apply(this, arguments);\n    }\n  }\n\n  function error(err) {\n    console.error(err);\n    actionStack.pop();\n    _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].alert(strings.error, err.toString());\n  }\n}\n\n//# sourceURL=webpack://com.foxdebug.acode/./src/pages/repo/repo.include.js?");

/***/ }),

/***/ "./src/pages/repo/repo.scss":
/*!**********************************!*\
  !*** ./src/pages/repo/repo.scss ***!
  \**********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n\n\n//# sourceURL=webpack://com.foxdebug.acode/./src/pages/repo/repo.scss?");

/***/ }),

/***/ "./src/pages/repo/list.hbs":
/*!*********************************!*\
  !*** ./src/pages/repo/list.hbs ***!
  \*********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = (\"<div class=\\\"list\\\" id=\\\"repo-list\\\" empty-message=\\\"{{msg}}\\\">{{#list}}{{#.}}\\r\\n  <div class=\\\"list-item\\\" sha=\\\"{{sha}}\\\" name=\\\"{{name}}\\\"\\r\\n    action=\\\"{{#isDirectory}}navigate{{/isDirectory}}{{#isFile}}file{{/isFile}}\\\">\\r\\n    <span class=\\\"icon {{icon}}\\\"></span>\\r\\n    <span class=\\\"container\\\">\\r\\n      <div class=\\\"text\\\">\\r\\n        <span>{{name}}</span>\\r\\n      </div>\\r\\n      {{#isFile}}\\r\\n      <small class=\\\"value\\\">{{size}}</small>\\r\\n      {{/isFile}}\\r\\n    </span>\\r\\n  </div>\\r\\n  {{/.}}{{/list}}\\r\\n</div>\");\n\n//# sourceURL=webpack://com.foxdebug.acode/./src/pages/repo/list.hbs?");

/***/ }),

/***/ "./src/pages/repo/repo.hbs":
/*!*********************************!*\
  !*** ./src/pages/repo/repo.hbs ***!
  \*********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = (\"<div class='main' id='repo-tree'>\\r\\n  <div class='navigation'></div>\\r\\n</div>\");\n\n//# sourceURL=webpack://com.foxdebug.acode/./src/pages/repo/repo.hbs?");

/***/ })

}]);