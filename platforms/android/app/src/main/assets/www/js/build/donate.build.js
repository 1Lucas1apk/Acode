"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkcom_foxdebug_acode"] = self["webpackChunkcom_foxdebug_acode"] || []).push([["donate"],{

/***/ "./src/pages/donate/donate.include.js":
/*!********************************************!*\
  !*** ./src/pages/donate/donate.include.js ***!
  \********************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ DonateInclude; }\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"./node_modules/@babel/runtime/regenerator/index.js\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _donate_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./donate.scss */ \"./src/pages/donate/donate.scss\");\n/* harmony import */ var _donate_hbs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./donate.hbs */ \"./src/pages/donate/donate.hbs\");\n/* harmony import */ var _product_hbs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./product.hbs */ \"./src/pages/donate/product.hbs\");\n/* harmony import */ var mustache__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! mustache */ \"./node_modules/mustache/mustache.mjs\");\n/* harmony import */ var _components_page__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../components/page */ \"./src/components/page.js\");\n/* harmony import */ var _lib_constants__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../lib/constants */ \"./src/lib/constants.js\");\n/* harmony import */ var _deadlyjack_ajax__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @deadlyjack/ajax */ \"./node_modules/@deadlyjack/ajax/dist/ajax.js\");\n/* harmony import */ var _deadlyjack_ajax__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_deadlyjack_ajax__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var _utils_helpers__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../utils/helpers */ \"./src/utils/helpers.js\");\n/* harmony import */ var _components_dialogs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../components/dialogs */ \"./src/components/dialogs.js\");\n/* harmony import */ var html_tag_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! html-tag-js */ \"./node_modules/html-tag-js/dist/tag.js\");\n/* harmony import */ var html_tag_js__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(html_tag_js__WEBPACK_IMPORTED_MODULE_11__);\n\n\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n\n\n\n\n\n\n\n\n\n //TODO: fix (-1 means, user is not logged in to any google account)\n\nfunction DonateInclude() {\n  var BASE_URL = \"https://acode.foxdebug.com/res/\";\n  var $page = (0,_components_page__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(strings.support);\n  var adShown = false;\n  actionStack.push({\n    id: 'donate page',\n    action: $page.hide\n  });\n\n  $page.onhide = function () {\n    actionStack.remove('donate page');\n    if (adShown) _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].hideAd();\n  };\n\n  app.append($page);\n  iap.setPurchaseUpdatedListener(function (purchases) {\n    if (Array.isArray(purchases)) {\n      (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[\"default\"])( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark(function _callee() {\n        var promises, _iterator, _step, _loop, settledPromises, rejectedPromise, msg, blob, url;\n\n        return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                promises = [];\n                _iterator = _createForOfIteratorHelper(purchases);\n\n                try {\n                  _loop = function _loop() {\n                    var purchase = _step.value;\n                    promises.push(new Promise(function (resolve, reject) {\n                      iap.consume(purchase.purchaseToken, function (resCode) {\n                        purchase.consumed = resCode === iap.OK ? true : false;\n                        purchase.consumeCode = resCode;\n                        resolve(purchase);\n                      }, function (err) {\n                        reject(err);\n                      });\n                    }));\n                  };\n\n                  for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                    _loop();\n                  }\n                } catch (err) {\n                  _iterator.e(err);\n                } finally {\n                  _iterator.f();\n                }\n\n                _context.next = 5;\n                return Promise.allSettled(promises);\n\n              case 5:\n                settledPromises = _context.sent;\n                rejectedPromise = settledPromises.find(function (promise) {\n                  return promise.status === 'rejected';\n                });\n                msg = \"\";\n\n                if (!rejectedPromise) {\n                  _context.next = 14;\n                  break;\n                }\n\n                msg = \"Something went wrong.\\n\";\n                msg += \"Error: \".concat(rejectedPromise.reason, \"\\n\");\n                msg += \"Code: \".concat(rejectedPromise.value.resCode);\n                _context.next = 20;\n                break;\n\n              case 14:\n                _context.next = 16;\n                return _deadlyjack_ajax__WEBPACK_IMPORTED_MODULE_8___default()({\n                  url: BASE_URL + \"6.jpeg\",\n                  responseType: \"blob\"\n                }).catch(function (err) {\n                  _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].error(err);\n                });\n\n              case 16:\n                blob = _context.sent;\n                url = URL.createObjectURL(blob);\n                msg = \"<img src=\\\"\".concat(url, \"\\\" class=\\\"donate-image\\\" />\");\n                msg += strings['donation message'];\n\n              case 20:\n                _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].alert(strings.info.toUpperCase(), msg);\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))();\n    }\n  }, function (err) {\n    if (err !== iap.USER_CANCELED) _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].alert(strings.error.toUpperCase(), err);\n  });\n\n  app.onclick = function (e) {\n    var $target = e.target;\n    if (!($target instanceof HTMLElement)) return;\n    var action = $target.getAttribute('action');\n    var value;\n\n    switch (action) {\n      case 'donate':\n        value = $target.getAttribute('value');\n        iap.purchase(value, function (purchase) {\n          console.log(purchase);\n        }, function (err) {\n          if (err !== iap.USER_CANCELED) _components_dialogs__WEBPACK_IMPORTED_MODULE_10__[\"default\"].alert(strings.error.toUpperCase(), err);\n        });\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].showTitleLoader();\n  (function () {\n    var _render = (0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__[\"default\"])( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark(function _callee2() {\n      var products, col1, col2;\n      return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return new Promise(function (resolve, reject) {\n                iap.getProducts(_lib_constants__WEBPACK_IMPORTED_MODULE_7__[\"default\"].SKULIST, function (products) {\n                  resolve(products);\n                }, function (err) {\n                  reject(err);\n                });\n              });\n\n            case 2:\n              products = _context2.sent;\n              products = products.sort(function (a, b) {\n                var aPrice = parseFloat(a.price.replace(/[^0-9.]/g, ''));\n                var bPrice = parseFloat(b.price.replace(/[^0-9.]/g, ''));\n                return aPrice - bPrice;\n              });\n              products = products.map(function (product) {\n                product.image = \"\".concat(BASE_URL).concat(product.productId === 'bronze' ? '1.jpeg' : '2.jpeg');\n                product.donate = strings.donate.replace('{amount}', product.price);\n                return product;\n              });\n              col1 = [];\n              col2 = [];\n              products.forEach(function (product, i) {\n                var html = mustache__WEBPACK_IMPORTED_MODULE_5__[\"default\"].render(_product_hbs__WEBPACK_IMPORTED_MODULE_4__[\"default\"], product);\n\n                if (i % 2 === 0) {\n                  col1.push(html);\n                  return;\n                }\n\n                col2.push(html);\n              });\n              $page.body = html_tag_js__WEBPACK_IMPORTED_MODULE_11___default().parse(mustache__WEBPACK_IMPORTED_MODULE_5__[\"default\"].render(_donate_hbs__WEBPACK_IMPORTED_MODULE_3__[\"default\"], {\n                col1: col1.join(''),\n                col2: col2.join('')\n              }));\n              _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].showAd();\n              adShown = true;\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    function render() {\n      return _render.apply(this, arguments);\n    }\n\n    return render;\n  })()().catch(function (error) {\n    actionStack.pop();\n    _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].error(error);\n  }).finally(function () {\n    _utils_helpers__WEBPACK_IMPORTED_MODULE_9__[\"default\"].removeTitleLoader();\n  });\n}\n\n//# sourceURL=webpack://com.foxdebug.acode/./src/pages/donate/donate.include.js?");

/***/ }),

/***/ "./src/pages/donate/donate.scss":
/*!**************************************!*\
  !*** ./src/pages/donate/donate.scss ***!
  \**************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n\n\n//# sourceURL=webpack://com.foxdebug.acode/./src/pages/donate/donate.scss?");

/***/ }),

/***/ "./src/pages/donate/donate.hbs":
/*!*************************************!*\
  !*** ./src/pages/donate/donate.hbs ***!
  \*************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = (\"<div id=\\\"donate-page\\\" class=\\\"main\\\">\\n  <div class=\\\"products\\\">\\n    <div class=\\\"col\\\">{{{col1}}}</div>\\n    <div class=\\\"col\\\">{{{col2}}}</div>\\n  </div>\\n</div>\");\n\n//# sourceURL=webpack://com.foxdebug.acode/./src/pages/donate/donate.hbs?");

/***/ }),

/***/ "./src/pages/donate/product.hbs":
/*!**************************************!*\
  !*** ./src/pages/donate/product.hbs ***!
  \**************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = (\"<div class=\\\"product\\\">\\n  <img src=\\\"{{image}}\\\" alt=\\\"{{id}}\\\">\\n  <div class=\\\"product-info\\\">\\n    <p>{{description}}</p>\\n    <div class=\\\"button-container primary\\\">\\n      <button action=\\\"donate\\\" value=\\\"{{json}}\\\">{{donate}}</button>\\n    </div>\\n  </div>\\n</div>\");\n\n//# sourceURL=webpack://com.foxdebug.acode/./src/pages/donate/product.hbs?");

/***/ })

}]);